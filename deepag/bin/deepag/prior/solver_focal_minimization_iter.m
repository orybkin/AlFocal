% Generated using GBSolver generator Copyright Martin Bujnak,
% Zuzana Kukelova, Tomas Pajdla CTU Prague 2008.
% 
% Please refer to the following paper, when using this code :
%     Kukelova Z., Bujnak M., Pajdla T., Automatic Generator of Minimal Problem Solvers,
%     ECCV 2008, Marseille, France, October 12-18, 2008

function [l1, l2] = solver_focal_minimization_iter(c11, c21)

	% precalculate polynomial equations coefficients
	c(1) = c11(4);
	c(2) = c11(11);
	c(3) = c11(12);
	c(4) = c11(1);
	c(5) = c11(13);
	c(6) = c11(3);
	c(7) = c11(6);
	c(8) = c11(2);
	c(9) = c11(7);
	c(10) = c11(5);
	c(11) = c11(8);
	c(12) = c11(9);
	c(13) = c11(14);
	c(14) = c11(10);
	c(15) = c11(15);
	c(16) = c21(4);
	c(17) = c21(11);
	c(18) = c21(12);
	c(19) = c21(1);
	c(20) = c21(13);
	c(21) = c21(3);
	c(22) = c21(6);
	c(23) = c21(2);
	c(24) = c21(7);
	c(25) = c21(5);
	c(26) = c21(8);
	c(27) = c21(9);
	c(28) = c21(14);
	c(29) = c21(10);
	c(30) = c21(15);

	M = zeros(20, 36);
	ci = [41, 62, 83, 104, 209, 230, 251, 355, 376, 479];
	M(ci) = c(1);

	ci = [81, 102, 123, 144, 249, 270, 291, 395, 416, 519];
	M(ci) = c(2);

	ci = [221, 242, 263, 284, 369, 390, 411, 495, 516, 599];
	M(ci) = c(3);

	ci = [1, 22, 43, 64, 169, 190, 211, 315, 336, 439];
	M(ci) = c(4);

	ci = [341, 362, 383, 404, 469, 490, 511, 575, 596, 659];
	M(ci) = c(5);

	ci = [161, 182, 203, 224, 309, 330, 351, 435, 456, 539];
	M(ci) = c(6);

	ci = [301, 322, 343, 364, 429, 450, 471, 535, 556, 619];
	M(ci) = c(7);

	ci = [21, 42, 63, 84, 189, 210, 231, 335, 356, 459];
	M(ci) = c(8);

	ci = [61, 82, 103, 124, 229, 250, 271, 375, 396, 499];
	M(ci) = c(9);

	ci = [181, 202, 223, 244, 329, 350, 371, 455, 476, 559];
	M(ci) = c(10);

	ci = [201, 222, 243, 264, 349, 370, 391, 475, 496, 579];
	M(ci) = c(11);

	ci = [321, 342, 363, 384, 449, 470, 491, 555, 576, 639];
	M(ci) = c(12);

	ci = [441, 462, 483, 504, 549, 570, 591, 635, 656, 699];
	M(ci) = c(13);

	ci = [421, 442, 463, 484, 529, 550, 571, 615, 636, 679];
	M(ci) = c(14);

	ci = [521, 542, 563, 584, 609, 630, 651, 675, 696, 719];
	M(ci) = c(15);

	ci = [45, 66, 87, 108, 212, 233, 254, 357, 378, 480];
	M(ci) = c(16);

	ci = [85, 106, 127, 148, 252, 273, 294, 397, 418, 520];
	M(ci) = c(17);

	ci = [225, 246, 267, 288, 372, 393, 414, 497, 518, 600];
	M(ci) = c(18);

	ci = [5, 26, 47, 68, 172, 193, 214, 317, 338, 440];
	M(ci) = c(19);

	ci = [345, 366, 387, 408, 472, 493, 514, 577, 598, 660];
	M(ci) = c(20);

	ci = [165, 186, 207, 228, 312, 333, 354, 437, 458, 540];
	M(ci) = c(21);

	ci = [305, 326, 347, 368, 432, 453, 474, 537, 558, 620];
	M(ci) = c(22);

	ci = [25, 46, 67, 88, 192, 213, 234, 337, 358, 460];
	M(ci) = c(23);

	ci = [65, 86, 107, 128, 232, 253, 274, 377, 398, 500];
	M(ci) = c(24);

	ci = [185, 206, 227, 248, 332, 353, 374, 457, 478, 560];
	M(ci) = c(25);

	ci = [205, 226, 247, 268, 352, 373, 394, 477, 498, 580];
	M(ci) = c(26);

	ci = [325, 346, 367, 388, 452, 473, 494, 557, 578, 640];
	M(ci) = c(27);

	ci = [445, 466, 487, 508, 552, 573, 594, 637, 658, 700];
	M(ci) = c(28);

	ci = [425, 446, 467, 488, 532, 553, 574, 617, 638, 680];
	M(ci) = c(29);

	ci = [525, 546, 567, 588, 612, 633, 654, 677, 698, 720];
	M(ci) = c(30);


	M = gj(M);

	A = zeros(16);
	amcols = [36 35 34 33 32 31 30 29 28 27 26 25 24 21 20 15];
	A(1, 3) = 1;
	A(2, 5) = 1;
	A(3, 6) = 1;
	A(4, 8) = 1;
	A(5, 9) = 1;
	A(6, 10) = 1;
	A(7, 12) = 1;
	A(8, 13) = 1;
	A(9, :) = -M(20, amcols);
	A(10, :) = -M(19, amcols);
	A(11, 15) = 1;
	A(12, :) = -M(18, amcols);
	A(13, :) = -M(17, amcols);
	A(14, :) = -M(14, amcols);
	A(15, :) = -M(13, amcols);
	A(16, :) = -M(7, amcols);

	[V D] = eig(A);
	sol =  V([3, 2],:)./(ones(2, 1)*V(1,:));

	if (find(isnan(sol(:))) > 0)
		
		l1 = zeros(1, 0);
		l2 = zeros(1, 0);
	else
		
		I = find(not(imag( sol(1,:) )));
		l1 = sol(1,I);
		l2 = sol(2,I);
	end
end
